)
m5 <- lm(model5_formula, data = repdata)
model5_formula <- as.formula(
paste("gdp_g",
"~",
paste("GPCP_g","GPCP_g_l","tot_100_g","ccode_factor",
paste(country_time_trend, collapse = "+")
, sep="+")
)
)
m5 <- lm(model5_formula, data = repdata)
model5_formula <- as.formula(
paste("gdp_g",
"~",
paste("GPCP_g","GPCP_g_l","tot_100_g",
paste(country_time_trend, collapse = "+")
, sep="+")
)
)
"Usando LM y luego coestest para los error standar robusto"
m5 <- lm(model5_formula, data = repdata)
robust_model5 <- coeftest(m5,
vcov = vcovCL,
type = "HC1",
cluster = ~ ccode)
sd_robust_model5 <- robust_model5[,2]
coefci(m5, df = Inf,
vcov. = vcovCL, cluster = ~ ccode, type = "HC1")
# RMSE manual
sq_resid <- m5$residuals**2
lm_rmse5 <- round( mean(sq_resid)^0.5, 2)
# Export tables ----
#
# stargazer::stargazer(ols_model1, ols_model2, ols_model3, ols_model4, ols_model5)
#
#
# stargazer::stargazer(ols_model5, se = starprep(ols_model5))
texreg(list(ols_model1, ols_model2, ols_model3, ols_model4, ols_model5),
custom.coef.map = list("GPCP_g"="Growth in rainfall, t",
"GPCP_g_l"="Growth in rainfall, t-1",
"GPCP_g_fl" = "Growth in rainfall,t+1",
"tot_100_g" = "Growth in terms of trade, t" ,
"y_0" = "Log(GDP per capita), 1979",
"polity2l" = "Democracy (Polity IV), t-1",
"ethfrac" = "Ethnolinguistic fractionalization",
"relfrac" = "Religious fractionalization",
"Oil" = "Oil-exporting country",
"lmtnest" = "Log(mountainous)",
"lpopl1" = "Log(national population), t-1"
), digits = 3,
stars = c(0.01, 0.05, 0.1),
custom.gof.rows = list("Country fixed effects" = c("no", "no", "yes", "yes", "yes"),
"Country-specific time trends" = c("no", "yes", "yes", "yes", "yes"),
"RMSE" = c(rmse1,rmse2,rmse3,rmse4,rmse5)),
caption = "Dependent Variable: Economic Growth Rate, t")
repdata  <- dummy_cols(repdata, select_columns = 'ccode')
#
index <- grep("ccode_", colnames(repdata))
# Dummy*time_var
repdata$time_year <- repdata$year - 1978 # creando la variable temporal
list_vars <- names(repdata)[index]
list_vars[1]
i = 1
# la variable de endencia de cada pais
while(i < 42){
var <- paste0(list_vars[i],"_","time") # nombre de la variable
repdata[var]  <- repdata[list_vars[i]]*repdata$time_year
i = i + 1
}
# TABLE 1: DESCRIPTIVE STATISTICS ----
table1 <- repdata %>% dplyr::select(any_prio, any_prio_on, any_prio_off,
war_prio, war_prio_on, war_prio_off, war_col, war_inc, war)
# table1 : firmate tbl
stargazer(table1)
# No obtenemos resultado pues la libreria exige que la base de datos sea DataFrame
table1 <- repdata %>% dplyr::select(any_prio, any_prio_on, any_prio_off,
war_prio, war_prio_on, war_prio_off, war_col, war_inc, war,
GPCP, GPCP_g, GPCP_g_l,gdp_g, gdp_g_l,
y_0, polity2l, polity2l_6, ethfrac, relfrac, Oil, lmtnest, lpopl1, tot_100_g) %>% as.data.frame()
# table1 : formato data.frame
stargazer(table1)
# Ajuste de algunos argumentos digits:
stargazer(table1, title = "Descriptive Statistics", digits = 2,
covariate.labels = c("Civil conflict with ≥25 deaths: (PRIO/
Uppsala)","Onset","Offset","Civil conflict with ≥1,000 deaths:
PRIO/Uppsala","Onset","Offset","Collier and Hoeffler (2002)",
"Doyle and Sambanis (2000)","Fearon and Laitin (2003)"))
stargazer(table1, title = "Descriptive Statistics", digits = 2,
covariate.labels = c("Civil conflict with ≥25 deaths: (PRIO/
Uppsala)","Onset","Offset","Civil conflict with ≥1,000 deaths:
PRIO/Uppsala","Onset","Offset","Collier and Hoeffler (2002)",
"Doyle and Sambanis (2000)","Fearon and Laitin (2003)"),
min.max = F)
# summary.stat = c("n", "p75", "sd") ordenar las columnas de los estadisticos
list_vars <- c("Civil conflict with ≥25 deaths: (PRIO/
Uppsala)","Onset","Offset","Civil conflict with ≥1,000 deaths:
PRIO/Uppsala","Onset","Offset","Collier and Hoeffler (2002)",
"Doyle and Sambanis (2000)","Fearon and Laitin (2003)",
"Annual rainfall (mm), GPCP measure",
"Annual growth in rainfall, time t",
"Annual growth in rainfall, time t-1",
"Annual economic growth rate, time t",
"Annual economic growth rate, time t-1",
"Log(GDP per capita), 1979",
"Democracy level (Polity IV score, -10 to 10), time t-1",
"Democracy indicator (Polity IV score > 15),
time t-1",
"Ethnolinguistic fractionalization (source:
Atlas Marodov Mira)",
"Religious fractionalization (source: CIA
Factbook)",
"Oil-exporting country (source: WDI)",
"Log(mountainous) (source: Fearon and
Laitin 2003)",
"Log(national population), time t-1
(source: WDI)",
"Growth in terms of trade, time t (source:
WDI)"
)
stargazer(table1, title = "Descriptive Statistics", digits = 2, # decimales con 2 digitos
covariate.labels = list_vars,  # Lista de etiquetas
summary.stat = c("mean", "sd", "n"), # se especifica el orden de los estadísticos
min.max = F, # borrar el estadístico de maximo y minimo (default es True)
notes = "Note.—The source of most characteristics is the World Bank’s World Development Indicators (WDI)."
, notes.append = FALSE, # TRUE append the significance levels
notes.align = 'l' # left : pegado a la izquierda
, out = "../../output/tables/summary_r.tex")
# TABLE 2: First stage ----
#### Primer Modelo ----
# OLS, sin efectos fijos o country-time trend
# errores estandar robustas (Huber robust)
# Los residuos estan clusterizados (agrupados) a nivel país
# Using cluster and robust standar error
m1 <- lm(gdp_g ~ GPCP_g + GPCP_g_l, data = repdata)
robust_model <- coeftest(m1,
vcov = vcovCL,  # Matrix varianza-covarianza cluster (CL)
type = "HC1",
cluster = ~ ccode)
sd_robust_model1 <- robust_model[,2]
lm_rmse1 <- RMSE(m1$fitted.values, repdata$gdp_g ) # root mean squeare error
# MSE = Suma cuadrado (y_predicho - y verdadero)^2
#### Segundo Modelo ----
# No efectos fijos (country), Si country-time trends
# errores estandar robustas (Huber-white robust)
# termino de perturbación están clusterizados (agrupados) a nivel país
# Se añade variables de control
control_vars <- c("y_0", "polity2l", "ethfrac", "relfrac", "Oil", "lmtnest","lpopl1")
# Usando as.formula pues el modelo se hace extenso
names(repdata)
index_country_time <- grep("_time$", colnames(repdata))
country_time_trend <-names(repdata)[index_country_time]
model2_formula <- as.formula(
paste("gdp_g",
"~",
paste("GPCP_g","GPCP_g_l", paste(country_time_trend, collapse = "+"),
paste(control_vars, collapse = "+")
,  sep="+") # este ultimo sep = + collapsa instrumentos, tendencia país y variables de control
)
)
"Usando LM y luego coestest para error standar robusto"
m2 <- lm(model2_formula, data = repdata)
lm_rmse2 <- round(RMSE(m2$fitted.values, repdata$gdp_g ) ,2 )
robust_model2 <- coeftest(m2,
vcov = vcovCL,
type = "HC1",
cluster = ~ ccode)
sd_robust_model2 <- robust_model2[,2]
coefci(m2, df = Inf,
vcov. = vcovCL, cluster = ~ ccode, type = "HC1")
#### Tercer Modelo ----
# Si efectos fijos (country), Si country-time trends
# errores estandar robustas (Huber robust)
# termino de perturbación están clusterizados (agrupados) a nivel país
# 1.0 Uso de lm_robust
index_country_time <- grep("_time$", colnames(repdata))
country_time_trend <-names(repdata)[index_country_time]
index_country <- grep("^ccode_\\d+$", colnames(repdata))
country_fe <-names(repdata)[index_country]
model3_formula <- as.formula(
paste("gdp_g",
"~",
paste("GPCP_g","GPCP_g_l", paste(country_time_trend, collapse = "+"),
paste(country_fe, collapse = "+")
, sep="+")
)
)
"Usando LM y luego coestest para los error standar robusto"
m3 <- lm(model3_formula, data = repdata)
lm_rmse3 <- round(RMSE(m3$fitted.values, repdata$gdp_g ) ,2 )
robust_model3 <- coeftest(m3 ,
vcov = vcovCL,
type = "HC1",
cluster = ~ ccode)
sd_robust_model3 <- robust_model3[,2]
#### Cuarto modelo ----
# Si efectos fijos (country), Si country-time trends
# errores estandar robustas (Huber robust)
# termino de perturbación están clusterizados (agrupados) a nivel país
# Se añade Growth in rainfall del siguiente año
model4_formula <- as.formula(
paste("gdp_g",
"~",
paste("GPCP_g","GPCP_g_l","GPCP_g_fl",
paste(country_time_trend, collapse = "+")
, sep="+")
)
)
"Usando LM y luego coestest para los error standar robusto"
m4 <- lm(model4_formula, data = repdata)
lm_rmse4 <- round(RMSE(m4$fitted.values, repdata$gdp_g ) ,2 )
robust_model4 <- coeftest(m4,
vcov = vcovCL,
type = "HC1",
cluster = ~ ccode)
sd_robust_model4 <- robust_model4[,2]
coefci(m4, df = Inf,
vcov. = vcovCL, cluster = ~ ccode, type = "HC1")
#### Quinto modelo ----
# Si efectos fijos (country), Si country-time trends
# errores estandar robustas (Huber robust)
# termino de perturbación están clusterizados (agrupados) a nivel país
# Se añade Growth in terms of trade
model5_formula <- as.formula(
paste("gdp_g",
"~",
paste("GPCP_g","GPCP_g_l","tot_100_g",
paste(country_time_trend, collapse = "+")
, sep="+")
)
)
"Usando LM y luego coestest para los error standar robusto"
m5 <- lm(model5_formula, data = repdata)
robust_model5 <- coeftest(m5,
vcov = vcovCL,
type = "HC1",
cluster = ~ ccode)
sd_robust_model5 <- robust_model5[,2]
coefci(m5, df = Inf,
vcov. = vcovCL, cluster = ~ ccode, type = "HC1")
# RMSE manual
sq_resid <- m5$residuals**2
lm_rmse5 <- round( mean(sq_resid)^0.5, 2)
# Export tables ----
#
# stargazer::stargazer(ols_model1, ols_model2, ols_model3, ols_model4, ols_model5)
#
#
# stargazer::stargazer(ols_model5, se = starprep(ols_model5))
texreg(list(ols_model1, ols_model2, ols_model3, ols_model4, ols_model5),
custom.coef.map = list("GPCP_g"="Growth in rainfall, t",
"GPCP_g_l"="Growth in rainfall, t-1",
"GPCP_g_fl" = "Growth in rainfall,t+1",
"tot_100_g" = "Growth in terms of trade, t" ,
"y_0" = "Log(GDP per capita), 1979",
"polity2l" = "Democracy (Polity IV), t-1",
"ethfrac" = "Ethnolinguistic fractionalization",
"relfrac" = "Religious fractionalization",
"Oil" = "Oil-exporting country",
"lmtnest" = "Log(mountainous)",
"lpopl1" = "Log(national population), t-1"
), digits = 3,
stars = c(0.01, 0.05, 0.1),
custom.gof.rows = list("Country fixed effects" = c("no", "no", "yes", "yes", "yes"),
"Country-specific time trends" = c("no", "yes", "yes", "yes", "yes"),
"RMSE" = c(rmse1,rmse2,rmse3,rmse4,rmse5)),
caption = "Dependent Variable: Economic Growth Rate, t")
stargazer( m1, m2, m3, m4, m5,
se=list(sd_robust_model1, sd_robust_model2, sd_robust_model3,
sd_robust_model4, sd_robust_model5),
dep.var.labels = c(""),
title = "Rainfall and Economic Growth (First-Stage)",
keep = c("GPCP_g","GPCP_g_l","GPCP_g_fl","tot_100_g","y_0",
"polity2l","ethfrac","relfrac","Oil",
"lmtnest","lpopl1"),
covariate.labels=c("Growth in rainfall, t","Growth in rainfall, t-1",
"Growth in rainfall, t+1",
"Growth in terms of trade, t","Log(GDP per capita), 1979",
"Democracy (Polity IV), t-1","Ethnolinguistic fractionalization",
"Religious fractionalization","Oil-exporting country",
"Log(mountainous)","Log(national population), t-1"),
align = T, no.space = T,
add.lines=list(c("Country fixed effects", "no", "no","yes","yes","yes"),
c("Country-specific time trends","no", "yes","yes","yes","yes"),
c("Root mean square error",lm_rmse1,lm_rmse2,lm_rmse3,lm_rmse4,lm_rmse5)),
keep.stat = c("rsq","n"),
notes.append = FALSE, notes.align = "l",
notes ="Huber robust standard errors are in parentheses", style = "qje"
, out = "../../output/tables/regression_table_r.tex")
repdata <- read_dta("../../data/dataverse_files/mss_repdata.dta")
str(repdata)
lapply(repdata, class)
names(repdata)
attributes(repdata)
summary(repdata)
# Observamos las etiquetas de variable de los valores de las variables
lapply(repdata, attr, 'label')
lapply(repdata, attr, 'labels')
repdata$ccode %>% attr('label') # var label
# dummy por país para efectos fijos
repdata  <- dummy_cols(repdata, select_columns = 'ccode')
#
index <- grep("ccode_", colnames(repdata))
# Dummy*time_var
repdata$time_year <- repdata$year - 1978 # creando la variable temporal
list_vars <- names(repdata)[index]
list_vars[1]
i = 1
# la variable de endencia de cada pais
while(i < 42){
var <- paste0(list_vars[i],"_","time") # nombre de la variable
repdata[var]  <- repdata[list_vars[i]]*repdata$time_year
i = i + 1
}
# TABLE 1: DESCRIPTIVE STATISTICS ----
table1 <- repdata %>% dplyr::select(any_prio, any_prio_on, any_prio_off,
war_prio, war_prio_on, war_prio_off, war_col, war_inc, war)
# table1 : firmate tbl
stargazer(table1)
# No obtenemos resultado pues la libreria exige que la base de datos sea DataFrame
table1 <- repdata %>% dplyr::select(any_prio, any_prio_on, any_prio_off,
war_prio, war_prio_on, war_prio_off, war_col, war_inc, war,
GPCP, GPCP_g, GPCP_g_l,gdp_g, gdp_g_l,
y_0, polity2l, polity2l_6, ethfrac, relfrac, Oil, lmtnest, lpopl1, tot_100_g) %>% as.data.frame()
# table1 : formato data.frame
stargazer(table1)
# Ajuste de algunos argumentos digits:
stargazer(table1, title = "Descriptive Statistics", digits = 2,
covariate.labels = c("Civil conflict with ≥25 deaths: (PRIO/
Uppsala)","Onset","Offset","Civil conflict with ≥1,000 deaths:
PRIO/Uppsala","Onset","Offset","Collier and Hoeffler (2002)",
"Doyle and Sambanis (2000)","Fearon and Laitin (2003)"))
stargazer(table1, title = "Descriptive Statistics", digits = 2,
covariate.labels = c("Civil conflict with ≥25 deaths: (PRIO/
Uppsala)","Onset","Offset","Civil conflict with ≥1,000 deaths:
PRIO/Uppsala","Onset","Offset","Collier and Hoeffler (2002)",
"Doyle and Sambanis (2000)","Fearon and Laitin (2003)"),
min.max = F)
# summary.stat = c("n", "p75", "sd") ordenar las columnas de los estadisticos
list_vars <- c("Civil conflict with ≥25 deaths: (PRIO/
Uppsala)","Onset","Offset","Civil conflict with ≥1,000 deaths:
PRIO/Uppsala","Onset","Offset","Collier and Hoeffler (2002)",
"Doyle and Sambanis (2000)","Fearon and Laitin (2003)",
"Annual rainfall (mm), GPCP measure",
"Annual growth in rainfall, time t",
"Annual growth in rainfall, time t-1",
"Annual economic growth rate, time t",
"Annual economic growth rate, time t-1",
"Log(GDP per capita), 1979",
"Democracy level (Polity IV score, -10 to 10), time t-1",
"Democracy indicator (Polity IV score > 15),
time t-1",
"Ethnolinguistic fractionalization (source:
Atlas Marodov Mira)",
"Religious fractionalization (source: CIA
Factbook)",
"Oil-exporting country (source: WDI)",
"Log(mountainous) (source: Fearon and
Laitin 2003)",
"Log(national population), time t-1
(source: WDI)",
"Growth in terms of trade, time t (source:
WDI)"
)
stargazer(table1, title = "Descriptive Statistics", digits = 2, # decimales con 2 digitos
covariate.labels = list_vars,  # Lista de etiquetas
summary.stat = c("mean", "sd", "n"), # se especifica el orden de los estadísticos
min.max = F, # borrar el estadístico de maximo y minimo (default es True)
notes = "Note.—The source of most characteristics is the World Bank’s World Development Indicators (WDI)."
, notes.append = FALSE, # TRUE append the significance levels
notes.align = 'l' # left : pegado a la izquierda
, out = "../../output/tables/summary_r.tex")
# TABLE 2: First stage ----
#### Primer Modelo ----
# OLS, sin efectos fijos o country-time trend
# errores estandar robustas (Huber robust)
# Los residuos estan clusterizados (agrupados) a nivel país
# Using cluster and robust standar error
m1 <- lm(gdp_g ~ GPCP_g + GPCP_g_l, data = repdata)
robust_model <- coeftest(m1,
vcov = vcovCL,  # Matrix varianza-covarianza cluster (CL)
type = "HC1",
cluster = ~ ccode)
sd_robust_model1 <- robust_model[,2]
lm_rmse1 <- RMSE(m1$fitted.values, repdata$gdp_g ) # root mean squeare error
# MSE = Suma cuadrado (y_predicho - y verdadero)^2
#### Segundo Modelo ----
# No efectos fijos (country), Si country-time trends
# errores estandar robustas (Huber-white robust)
# termino de perturbación están clusterizados (agrupados) a nivel país
# Se añade variables de control
control_vars <- c("y_0", "polity2l", "ethfrac", "relfrac", "Oil", "lmtnest","lpopl1")
# Usando as.formula pues el modelo se hace extenso
names(repdata)
index_country_time <- grep("_time$", colnames(repdata))
country_time_trend <-names(repdata)[index_country_time]
model2_formula <- as.formula(
paste("gdp_g",
"~",
paste("GPCP_g","GPCP_g_l", paste(country_time_trend, collapse = "+"),
paste(control_vars, collapse = "+")
,  sep="+") # este ultimo sep = + collapsa instrumentos, tendencia país y variables de control
)
)
"Usando LM y luego coestest para error standar robusto"
m2 <- lm(model2_formula, data = repdata)
lm_rmse2 <- round(RMSE(m2$fitted.values, repdata$gdp_g ) ,2 )
robust_model2 <- coeftest(m2,
vcov = vcovCL,
type = "HC1",
cluster = ~ ccode)
sd_robust_model2 <- robust_model2[,2]
coefci(m2, df = Inf,
vcov. = vcovCL, cluster = ~ ccode, type = "HC1")
#### Tercer Modelo ----
# Si efectos fijos (country), Si country-time trends
# errores estandar robustas (Huber robust)
# termino de perturbación están clusterizados (agrupados) a nivel país
# 1.0 Uso de lm_robust
index_country_time <- grep("_time$", colnames(repdata))
country_time_trend <-names(repdata)[index_country_time]
index_country <- grep("^ccode_\\d+$", colnames(repdata))
country_fe <-names(repdata)[index_country]
model3_formula <- as.formula(
paste("gdp_g",
"~",
paste("GPCP_g","GPCP_g_l", paste(country_time_trend, collapse = "+"),
paste(country_fe, collapse = "+")
, sep="+")
)
)
"Usando LM y luego coestest para los error standar robusto"
m3 <- lm(model3_formula, data = repdata)
lm_rmse3 <- round(RMSE(m3$fitted.values, repdata$gdp_g ) ,2 )
robust_model3 <- coeftest(m3 ,
vcov = vcovCL,
type = "HC1",
cluster = ~ ccode)
sd_robust_model3 <- robust_model3[,2]
#### Cuarto modelo ----
# Si efectos fijos (country), Si country-time trends
# errores estandar robustas (Huber robust)
# termino de perturbación están clusterizados (agrupados) a nivel país
# Se añade Growth in rainfall del siguiente año
model4_formula <- as.formula(
paste("gdp_g",
"~",
paste("GPCP_g","GPCP_g_l","GPCP_g_fl",
paste(country_time_trend, collapse = "+")
, sep="+")
)
)
"Usando LM y luego coestest para los error standar robusto"
m4 <- lm(model4_formula, data = repdata)
lm_rmse4 <- round(RMSE(m4$fitted.values, repdata$gdp_g ) ,2 )
robust_model4 <- coeftest(m4,
vcov = vcovCL,
type = "HC1",
cluster = ~ ccode)
sd_robust_model4 <- robust_model4[,2]
coefci(m4, df = Inf,
vcov. = vcovCL, cluster = ~ ccode, type = "HC1")
#### Quinto modelo ----
# Si efectos fijos (country), Si country-time trends
# errores estandar robustas (Huber robust)
# termino de perturbación están clusterizados (agrupados) a nivel país
# Se añade Growth in terms of trade
model5_formula <- as.formula(
paste("gdp_g",
"~",
paste("GPCP_g","GPCP_g_l","tot_100_g",
paste(country_time_trend, collapse = "+")
, sep="+")
)
)
"Usando LM y luego coestest para los error standar robusto"
m5 <- lm(model5_formula, data = repdata)
robust_model5 <- coeftest(m5,
vcov = vcovCL,
type = "HC1",
cluster = ~ ccode)
sd_robust_model5 <- robust_model5[,2]
coefci(m5, df = Inf,
vcov. = vcovCL, cluster = ~ ccode, type = "HC1")
# RMSE manual
sq_resid <- m5$residuals**2
lm_rmse5 <- round( mean(sq_resid)^0.5, 2)
# Export tables ----
# digits: 3 digitos
# stars = c(0.01, 0.05, 0.1), *** 1%, ** 5%, ** 10%
# Export using Stagezer
stargazer( m1, m2, m3, m4, m5,
se=list(sd_robust_model1, sd_robust_model2, sd_robust_model3,
sd_robust_model4, sd_robust_model5),
dep.var.labels = c(""),
title = "Rainfall and Economic Growth (First-Stage)",
keep = c("GPCP_g","GPCP_g_l","GPCP_g_fl","tot_100_g","y_0",
"polity2l","ethfrac","relfrac","Oil",
"lmtnest","lpopl1"),
covariate.labels=c("Growth in rainfall, t","Growth in rainfall, t-1",
"Growth in rainfall, t+1",
"Growth in terms of trade, t","Log(GDP per capita), 1979",
"Democracy (Polity IV), t-1","Ethnolinguistic fractionalization",
"Religious fractionalization","Oil-exporting country",
"Log(mountainous)","Log(national population), t-1"),
align = T, no.space = T,
add.lines=list(c("Country fixed effects", "no", "no","yes","yes","yes"),
c("Country-specific time trends","no", "yes","yes","yes","yes"),
c("Root mean square error",lm_rmse1,lm_rmse2,lm_rmse3,lm_rmse4,lm_rmse5)),
keep.stat = c("rsq","n"),
notes.append = FALSE, notes.align = "l",
notes ="Huber robust standard errors are in parentheses", style = "qje"
, out = "../../output/tables/regression_table_r.tex")
