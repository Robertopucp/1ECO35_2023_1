geom_sf(data = df5_filter, aes(fill = prop_wom), linetype = "dotted",
color = "black") +
scale_fill_gradient(
low = "white", high = "red"
) +
theme_void() +
theme(legend.position = "right",
legend.title=element_blank()) +
labs( title = month)
# Add the plot to the list
plots[[month]] <- p
}
# Combine the plots into a single plot
grid.arrange(grobs = plots, ncol = 3)
min <- min(df5$prop_wom)
max <- max(df5$prop_wom)
my_breaks <- c(min, 20, 30,40, 50, 100)
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),
linetype = "dotted",  color = "black") +
scale_fill_gradient(
low = "white", high = "orange",
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04 , 20",
"20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 7),
strip.background = element_blank()
)
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),
linetype = "dotted",  color = "black") +
scale_fill_manual(
low = "white", high = "orange",
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04 , 20",
"20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 7),
strip.background = element_blank()
)
my_palette <- c("#FFF5EB", "#FFDAB9", "#FFA07A", "#FF8C00", "#FF4500")
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),
linetype = "dotted",  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04 , 20",
"20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 7),
strip.background = element_blank()
)
df5$prop_wom[df5$NOMBDEP == "LIMA"] <- NA
### Mapa con missing value  --------------
min <- min(df5$prop_wom)
max <- max(df5$prop_wom)
my_breaks <- c(min, 20, 30,40, 50, 100)
my_palette <- c("#FFF5EB", "#FFDAB9", "#FFA07A", "#FF8C00", "#FF4500")
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),
linetype = "dotted",  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04 , 20",
"20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 7),
strip.background = element_blank()
)
levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE))
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),
linetype = "dotted",  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c(                             "20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 7),
strip.background = element_blank()
)
df5 <- dpt_shp |>
left_join(df4, by = c("CCDD"="dpt_code"))
# month names from numbers
df5$month_name <- month.name[df5$month]
### Mapas por mes --------------
# Define the grid of subplots
grid <- expand.grid(row = 1:4, col = 1:3)
# Define the figure size
options(repr.plot.width=15, repr.plot.height=15)
# Create a list of plots
plots <- list()
# Loop through each subplot
for (i in 1:nrow(grid)) {
# Subset the data for the current month
month <- unique(df5$month_name)[i]
df5_filter <- df5[df5$month_name == month,]
# Create the choropleth map
p <-ggplot() +
geom_sf(data = df5_filter, aes(fill = prop_wom), linetype = "dotted",
color = "black") +
scale_fill_gradient(
low = "white", high = "red"
) +
theme_void() +
theme(legend.position = "right",
legend.title=element_blank()) +
labs( title = month)
# Add the plot to the list
plots[[month]] <- p
}
# Combine the plots into a single plot
grid.arrange(grobs = plots, ncol = 3)
# Replace missing Lima
df5$prop_wom[df5$NOMBDEP == "LIMA"] <- NA
### Mapa con missing value  --------------
min <- min(df5$prop_wom)
max <- max(df5$prop_wom)
my_breaks <- c(min, 20, 30,40, 50, 100)
my_palette <- c("#FFF5EB", "#FFDAB9", "#FFA07A", "#FF8C00", "#FF4500")
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),
linetype = "dotted",  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 7),
strip.background = element_blank()
)
ggsave("../../output/plots/map_pea_women.jpg"
, height = 7  # alto
, width = 9  # ancho
, dpi = 320   # resolución (calidad de la imagen)
)
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 7),
strip.background = element_blank()
)
ggsave("../../output/plots/map_pea_women.jpg"
, height = 7  # alto
, width = 9  # ancho
, dpi = 320   # resolución (calidad de la imagen)
)
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 5),
strip.background = element_blank()
) +
guides(color = guide_legend(override.aes = list(shape = 21)))
cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE)
min <- min(df5$prop_wom)
min
min <- min(df5$prop_wom, na.rm = T)
min
min <- min(df5$prop_wom, na.rm = T)
max <- max(df5$prop_wom)
my_breaks <- c(min, 20, 30,40, 50, 100)
my_palette <- c("#FFF5EB", "#FFDAB9", "#FFA07A", "#FF8C00", "#FF4500")
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 5),
strip.background = element_blank()
)
ggsave("../../output/plots/map_pea_women.jpg"
, height = 7  # alto
, width = 9  # ancho
, dpi = 320   # resolución (calidad de la imagen)
)
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
strip.background = element_blank()
)
ggsave("../../output/plots/map_pea_women.jpg"
, height = 7  # alto
, width = 9  # ancho
, dpi = 320   # resolución (calidad de la imagen)
)
p <- ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
strip.background = element_blank()
)
ggsave("../../output/plots/map_pea_women.jpg"
, height = 7  # alto
, width = 9  # ancho
, dpi = 320   # resolución (calidad de la imagen)
)
# Modify the legend marker shape
p <- p + guides(color = guide_legend(override.aes = list(shape = 21)),
shape = guide_legend(override.aes = list(shape = 21)))
p <- ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
scale_shape_manual(values = 21 ) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
strip.background = element_blank()
)
ggsave("../../output/plots/map_pea_women.jpg"
, height = 7  # alto
, width = 9  # ancho
, dpi = 320   # resolución (calidad de la imagen)
)
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100"
)) +
scale_shape_manual(values = c(21,21,21,21) ) +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
strip.background = element_blank()
)
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100",
),
na.value = "grey") +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
strip.background = element_blank()
)
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100","No Data"
),
na.value = "grey") +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
strip.background = element_blank()
)
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100"
),
na.value = "grey") +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
strip.background = element_blank()
)
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100"
),
na.value = "grey") +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
strip.background = element_blank()
) +
guides(shape = guide_legend(override.aes = list(shape = 21, fill = "red", size = 3)))
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100"
),
na.value = "grey") +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
strip.background = element_blank()
) +
geom_point(aes(x = 0, y = 0), shape = 21, fill = "red", size = 3) +
guides(shape = guide_legend(override.aes = list(shape = 21, fill = "red", size = 3)))
ggplot() +
geom_sf(data = df5, aes(fill = cut(prop_wom, breaks = my_breaks,
include.lowest = TRUE)),  color = "black") +
scale_fill_manual(
values = my_palette,
name = "Women proportion",
breaks = levels(cut(df5$prop_wom, breaks = my_breaks,
include.lowest = TRUE
)),
labels = c("14.04, 20", "20, 30",
"30, 40",
"40, 50",
"50, 100"
),
na.value = "grey") +
theme_void() +
theme(legend.position = "right",
legend.title = element_text(size = 10),
legend.text = element_text(size = 8),
strip.background = element_blank()
) +
guides(shape = guide_legend(override.aes = list(shape = 21, fill = "red",
size = 3)))
